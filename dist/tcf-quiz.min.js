/*!
 (c)2016 The Coding Forge
 tcf-quiz 1.0.0 
 Generated on: 2016-05-14 
*/
jQuery.fn.tcf_quiz=function(a){var b={finalFeedback:"Congrats",currentQuestion:1,correctCount:0,titleText:"Quiz",instructions:"Please answer the below questions.",advanceOnIncorrect:!0},c=$.extend({},b,a),d={init:function(){d.createElementVariables(),d.appendWrappers(),d.appendHeaderChildren(),d.updateQuestionCounter(),d.appendQuestion(),d.appendAnswers(),d.appendButtons(),d.bindButtons()},createElementVariables:function(){c.elements.headerWrap=$("<div>"),c.elements.questionWrap=$("<div class='tcf-quiz-top-buffer'>"),c.elements.answersWrap=$("<div>"),c.elements.buttonWrap=$("<div>"),c.elements.feedbackWrap=$("<div>"),c.elements.titleText=$("<h1>"+c.titleText+"</h1>"),c.elements.instructions=$("<p class='tcf-quiz-top-buffer'>"+c.instructions+"</p>"),c.elements.questionCounter=$("<p class='tcf-quiz-counter'></p>"),c.elements.checkBtn=$("<button type='button'>Check Answers</button>"),c.elements.nextBtn=$("<button type='button'>Next Question</button>"),c.elements.resetBtn=$("<button type='button'>Reset Quiz</button>")},appendWrappers:function(){c.elements.main.append(c.elements.headerWrap),c.elements.main.append(c.elements.questionWrap),c.elements.main.append(c.elements.answersWrap),c.elements.main.append(c.elements.buttonWrap),c.elements.main.append(c.elements.feedbackWrap)},appendHeaderChildren:function(){c.elements.headerWrap.append(c.elements.questionCounter),c.elements.headerWrap.append(c.elements.titleText),c.elements.headerWrap.append(c.elements.instructions)},updateQuestionCounter:function(){var a="<b>"+c.currentQuestion+"</b>/"+c.questions.length;c.elements.questionCounter.html(a)},appendQuestion:function(){c.elements.questionWrap.html("");var a=c.questions[c.currentQuestion-1];c.elements.questionWrap.append("<p>"+a.questionText+"</p>")},appendAnswers:function(){var a=c.questions[c.currentQuestion-1].questionType;"radio"==a?d.buildRadioAnswers():"checkbox"==a?d.buildCheckboxAnswers():"textarea"==a?d.buildTextareaAnswer():"cloze"==a&&d.buildClozeAnswer()},buildRadioAnswers:function(){var a=c.questions[c.currentQuestion-1].answers;c.elements.answersWrap.html(""),$(a).each(function(b){var d=a[b].answerText;if(a[b].correctAnswer)var e="<input data-correct='1' type='radio' name='tcf-radio'/> ";else var e="<input data-correct='0' type='radio' name='tcf-radio'/> ";c.elements.answersWrap.append("<p>"+e+d+"</p>")})},buildCheckboxAnswers:function(){var a=c.questions[c.currentQuestion-1].answers;c.elements.answersWrap.html(""),$(a).each(function(b){var d=a[b].answerText;if(a[b].correctAnswer)var e="<input data-correct='1' type='checkbox' name='tcf-checkbox'/> ";else var e="<input data-correct='0' type='checkbox' name='tcf-checkbox'/> ";c.elements.answersWrap.append("<p>"+e+d+"</p>")})},buildTextareaAnswer:function(){c.questions[c.currentQuestion-1].answers;c.elements.answersWrap.html(""),c.elements.answersWrap.append("<textarea></textarea>")},buildClozeAnswer:function(){var a=c.questions[c.currentQuestion-1].answers[0].answerText,b=d.extractClozeQuestion(a);c.elements.answersWrap.html(""),c.elements.answersWrap.append(b)},extractClozeQuestion:function(a){var b=[];return $.each(a.split(""),function(a,c){"["==c&&b.push(a+1),"]"==c&&b.push(a)}),d.getClozeAnswerArr(b,a)},getClozeAnswerArr:function(a,b){var c=[];c.push(b.substring(0,a[0])),$.each(a,function(d,e){c.push(b.substring(a[d],a[d+1]))});var d=[];return $.each(c,function(a,b){if(c[a].endsWith("[")&&c[a].startsWith("]"))d.push(c[a].substring(1,c[a].length-1));else if(c[a].startsWith("]"))d.push(c[a].substring(1,c[a].length));else if(c[a].endsWith("["))d.push(c[a].substring(0,c[a].length-1));else{var e=c[a].split(","),f=[];f.push("<select>"),f.push("<option value='none'>-- Select An Answer --</option>"),$.each(e,function(a,b){var c=e[a].trim();c.startsWith("*")?f.push("<option data-correct='true' value='"+c.replace("*","")+"'>"+c.replace("*","")+"</option>"):f.push("<option value='"+c+"'>"+c+"</option>")}),f.push("</select>"),d.push(f.join(""))}}),d.join("")},appendButtons:function(){c.elements.buttonWrap.append(c.elements.checkBtn),c.elements.buttonWrap.append(c.elements.nextBtn.hide()),c.elements.buttonWrap.append(c.elements.resetBtn.hide())},bindButtons:function(){c.elements.checkBtn.click(function(){var a=c.questions[c.currentQuestion-1].questionType;"radio"==a?d.checkRadioAnswers():"checkbox"==a?d.checkCheckboxAnswers():"textarea"==a?d.checkTextareaAnswer():"cloze"==a&&d.checkClozeAnswer()}),c.elements.nextBtn.click(function(){d.nextQuestion()}),c.elements.resetBtn.click(function(){d.resetQuiz()})},checkRadioAnswers:function(){var a=(c.questions[c.currentQuestion-1].answers,$(c.elements.answersWrap.children())),b=a.find("input[type='radio']:checked"),e=b.parent().index(),f=a.find("input[data-correct='1']").parent().index();0==b.length?d.appendAlertFeedback("Please select an answer."):(e==f?d.appendCorrectFeedback(e):d.appendIncorrectFeedback(e),a.find("input[type='radio']").attr("disabled","disabled"))},checkCheckboxAnswers:function(){var a=(c.questions[c.currentQuestion-1].answers,$(c.elements.answersWrap.children())),b=a.find("input[data-correct='1']").length,e=0,f=a.find("input[type='checkbox']:checked");0==f.length?d.appendAlertFeedback("Please select an answer."):(a.find("input[type='checkbox']").each(function(a){$(this).is(":checked")&&e++}),e==b?d.appendCorrectFeedback():d.appendIncorrectFeedback(),a.find("input[type='checkbox']").attr("disabled","disabled"))},checkTextareaAnswer:function(){var a=$(c.elements.answersWrap.children());0==$(a[0]).val().length?d.appendAlertFeedback("Please enter your answer."):(a.attr("disabled","disabled"),d.appendTextareaFeedback())},checkClozeAnswer:function(){var a=$(c.elements.answersWrap.children()),b=a.find("select"),e=!0,f=!0;$(b.prevObject).each(function(a){"none"==$(this).val()&&($(this).css("border","1px solid red"),e=!1)}),e?$(b.prevObject).find("option:selected").each(function(a){$(this).parent().attr("disabled","disabled"),1==$(this).data("correct")?$(this).parent().css("border","1px solid green"):(f=!1,$(this).parent().css("border","1px solid red"))}):(d.appendAlertFeedback("Please select all answers."),f=!1),f&&e?d.appendCorrectFeedback():!f&&e&&d.appendIncorrectFeedback()},appendCorrectFeedback:function(a){var b=c.questions[c.currentQuestion-1];c.elements.feedbackWrap.show(),c.correctCount++,c.elements.checkBtn.hide(),c.elements.nextBtn.show(),c.currentQuestion==c.questions.length&&c.elements.nextBtn.html("Finish Quiz"),"radio"==b.questionType&&void 0!=b.answers[a].feedback?c.elements.feedbackWrap.html("<p>"+b.answers[a].feedback+"</p>"):void 0!=b.feedback?void 0!=b.feedback[0].correct?c.elements.feedbackWrap.html("<p>"+b.feedback[0].correct+"</p>"):void 0!=b.feedback[0].generic?c.elements.feedbackWrap.html("<p>"+b.feedback[0].generic+"</p>"):c.elements.feedbackWrap.html("<p>Correct</p>"):c.elements.feedbackWrap.html("<p>Correct</p>"),c.elements.feedbackWrap.addClass("tcf-quiz-top-buffer")},appendIncorrectFeedback:function(a){var b=c.questions[c.currentQuestion-1];c.elements.feedbackWrap.show(),c.advanceOnIncorrect&&(c.elements.checkBtn.hide(),c.elements.nextBtn.show(),c.currentQuestion==c.questions.length&&c.elements.nextBtn.html("View Results"),"radio"==b.questionType&&void 0!=b.answers[a].feedback?c.elements.feedbackWrap.html("<p>"+b.answers[a].feedback+"</p>"):void 0!=b.feedback?void 0!=b.feedback[0].incorrect?c.elements.feedbackWrap.html("<p>"+b.feedback[0].incorrect+"</p>"):void 0!=b.feedback[0].generic?c.elements.feedbackWrap.html("<p>"+b.feedback[0].generic+"</p>"):c.elements.feedbackWrap.html("<p>Incorrect</p>"):c.elements.feedbackWrap.html("<p>Incorrect</p>")),c.elements.feedbackWrap.addClass("tcf-quiz-top-buffer")},appendAlertFeedback:function(a){c.elements.feedbackWrap.show(),c.elements.feedbackWrap.html("<p>"+a+"</p>"),c.elements.feedbackWrap.addClass("tcf-quiz-top-buffer")},appendTextareaFeedback:function(){c.elements.feedbackWrap.show();var a=c.questions[c.currentQuestion-1].answers[0].answerText;c.elements.feedbackWrap.html("<p'><b>Model Response:</b></p><p>"+a+"</p>"),c.elements.checkBtn.hide(),c.elements.nextBtn.show(),c.elements.feedbackWrap.addClass("tcf-quiz-top-buffer")},nextQuestion:function(){c.currentQuestion==c.questions.length?(c.elements.feedbackWrap.hide(),d.finalFeedback(),c.elements.resetBtn.show(),c.elements.nextBtn.hide()):(c.elements.feedbackWrap.hide(),c.currentQuestion++,d.appendQuestion(),d.appendAnswers(),d.updateQuestionCounter(),c.elements.checkBtn.show(),c.elements.nextBtn.hide())},finalFeedback:function(){c.elements.feedbackWrap.detach(),c.elements.feedbackWrap.insertBefore(c.elements.buttonWrap),c.elements.feedbackWrap.show(),c.elements.questionWrap.hide(),c.elements.answersWrap.hide(),c.elements.feedbackWrap.html("<p>"+c.finalFeedback+"</p>")},resetQuiz:function(){c.elements.feedbackWrap.detach().hide(),c.elements.feedbackWrap.insertAfter(c.elements.buttonWrap),c.currentQuestion=1,c.correctCount=0,d.appendQuestion(),d.appendAnswers(),d.updateQuestionCounter(),c.elements.questionWrap.show(),c.elements.answersWrap.show(),c.elements.checkBtn.show(),c.elements.nextBtn.hide().html("Next Question"),c.elements.resetBtn.hide()}};return this.each(function(){c.elements={},c.elements.main=$(this),d.init(this)})};